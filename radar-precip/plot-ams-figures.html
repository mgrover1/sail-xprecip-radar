
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Plot PPI data for BAMS Paper &#8212; SAIL X-Band Radar Precipitation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plot a Description of the Liquid Precip Estimation Method" href="plot-method-description-figure.html" />
    <link rel="prev" title="Snowfall Retrievals CSU X-Band Radar March 14, 2022" href="csu-xband-snowfall-march-14-2022.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/arm_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SAIL X-Band Radar Precipitation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../overview.html">
                    Surface Atmosphere Integrated Field Laboratory (SAIL) Radar Analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Looking at the Domain
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../domain-exploration/plot-sail-splash-sites.html">
   Plot the SAIL and SPLASH Locations
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Apply Quality Control/Assurance
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../gluing_and_inventory/concatinate_file.html">
   Gluing and Merging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../qc/sail_beam_blockage.html">
   Beam Blockage for SAIL
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Dual-Pol Exploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../dual-pol/dual-pol-exploration.html">
   Explore Dual-Pol Data from SAIL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../dual-pol/kdp-xradar-exploration.html">
   Investigate KDP and PhiDP through a Convective Core near SAIL
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Investigate Precipitation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="compare-with-kazr.html">
   Check Reflectivity Calibration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="csu-xband-snowfall-march-14-2022.html">
   Snowfall Retrievals CSU X-Band Radar March 14, 2022
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Plot PPI data for BAMS Paper
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot-method-description-figure.html">
   Plot a Description of the Liquid Precip Estimation Method
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Value Added Products
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../VAP/cmac2_technical_document.html">
   Figures for the SAIL CMAC2.0 Technical Document
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VAP/matched_dataset_march_14_2022.html">
   Extracted Radar Columns and In-Situ Sensors (RadCLss) Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../VAP/nearest-neighbor-interpolation.html">
   Grid QC’d Dataset - Surface QUantitatIve pRecipitation Estimation (SQUIRE)
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ARM-Development/sail-xprecip-radar/main?urlpath=lab/tree/notebooks/radar-precip/plot-ams-figures.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://jupyter-open.olcf.ornl.gov/hub/user-redirect/git-pull?repo=https%3A//github.com/ARM-Development/sail-xprecip-radar&urlpath=lab/tree/sail-xprecip-radar/notebooks/radar-precip/plot-ams-figures.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/radar-precip/plot-ams-figures.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-watershed-and-instrumentation-locations">
     Read the Watershed and Instrumentation Locations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-the-dem-data">
     Retrieve the DEM Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-helper-functions">
   Setup Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-reflectivity-with-the-pluvio-sensor-and-watershed-locations">
   Plot the Reflectivity with the Pluvio Sensor and Watershed Locations
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Plot PPI data for BAMS Paper</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-the-watershed-and-instrumentation-locations">
     Read the Watershed and Instrumentation Locations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#retrieve-the-dem-data">
     Retrieve the DEM Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup-helper-functions">
   Setup Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-the-reflectivity-with-the-pluvio-sensor-and-watershed-locations">
   Plot the Reflectivity with the Pluvio Sensor and Watershed Locations
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="plot-ppi-data-for-bams-paper">
<h1>Plot PPI data for BAMS Paper<a class="headerlink" href="#plot-ppi-data-for-bams-paper" title="Permalink to this headline">#</a></h1>
<p>Plot maps for the SAIL Bulletin of the American Meteorological Society (BAMS) submission.</p>
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import glob
import os
import datetime
import warnings
import numpy as np
import matplotlib.pyplot as plt
import pyart
import xarray as xr
import cartopy.crs as ccrs
import cartopy.feature as cfeature
from matplotlib.dates import DateFormatter
import pandas as pd
import geopandas as gpd
from metpy.plots import USCOUNTIES
from matplotlib.colors import ListedColormap
from datetime import datetime
import act
import fiona
from podpac.datalib.terraintiles import TerrainTiles
from podpac import Coordinates, clinspace
import hvplot as hv
import hvplot.xarray
import numpy as np
from math import atan2 as atan2
from matplotlib import colors
from matplotlib import ticker, cm
fiona.drvsupport.supported_drivers[&#39;lib?kml&#39;] = &#39;rw&#39; # enable KML support which is disabled by default
fiona.drvsupport.supported_drivers[&#39;LIBKML&#39;] = &#39;rw&#39; # enable KML support which is disabled by default
warnings.filterwarnings(&#39;ignore&#39;)
</pre></div>
</div>
</div>
</div>
<section id="read-the-watershed-and-instrumentation-locations">
<h3>Read the Watershed and Instrumentation Locations<a class="headerlink" href="#read-the-watershed-and-instrumentation-locations" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>east_river = gpd.read_file(&#39;data/site-locations/East_River.kml&#39;)
splash_locations = gpd.read_file(&#39;data/site-locations/SPLASH_Instruments.kml&#39;)
amf_sensor_locations = gpd.read_file(&#39;data/site-locations/SAIL_Instruments.kml&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="retrieve-the-dem-data">
<h3>Retrieve the DEM Data<a class="headerlink" href="#retrieve-the-dem-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>min_lat = 38.8
max_lat = 39.1
min_lon = -107.2
max_lon = -106.7

# create terrain tiles node
node = TerrainTiles(tile_format=&#39;geotiff&#39;, zoom=10)

# create coordinates to get tiles
c = Coordinates([clinspace(min_lat, max_lat, 1000), clinspace(min_lon, max_lon, 1000)], dims=[&#39;lat&#39;, &#39;lon&#39;])

# evaluate node
terrain = node.eval(c)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="setup-helper-functions">
<h2>Setup Helper Functions<a class="headerlink" href="#setup-helper-functions" title="Permalink to this headline">#</a></h2>
<p>We need these helper functions to create the scale bar within our figure</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def gc_latlon_bear_dist(lat1, lon1, bear, dist):
    &quot;&quot;&quot;
    Input lat1/lon1 as decimal degrees, as well as bearing and distance from
    the coordinate. Returns lat2/lon2 of final destination. Cannot be
    vectorized due to atan2.
    &quot;&quot;&quot;
    re = 6371.1  # km
    lat1r = np.deg2rad(lat1)
    lon1r = np.deg2rad(lon1)
    bearr = np.deg2rad(bear)
    lat2r = np.arcsin((np.sin(lat1r) * np.cos(dist/re)) +
                      (np.cos(lat1r) * np.sin(dist/re) * np.cos(bearr)))
    lon2r = lon1r + atan2(np.sin(bearr) * np.sin(dist/re) *
                          np.cos(lat1r), np.cos(dist/re) - np.sin(lat1r) *
                          np.sin(lat2r))
    return np.rad2deg(lat2r), np.rad2deg(lon2r)
 
    
def add_scale_line(scale, ax, projection, color=&#39;k&#39;,
                  linewidth=None, fontsize=None, fontweight=None):
    &quot;&quot;&quot;
    Adds a line that shows the map scale in km. The line will automatically
    scale based on zoom level of the map. Works with cartopy.
 
    Parameters
    ----------
    scale : scalar
        Length of line to draw, in km.
    ax : matplotlib.pyplot.Axes instance
        Axes instance to draw line on. It is assumed that this was created
        with a map projection.
    projection : cartopy.crs projection
        Cartopy projection being used in the plot.
 
    Other Parameters
    ----------------
    color : str
        Color of line and text to draw. Default is black.
    &quot;&quot;&quot;
    frac_lat = 0.1  # distance fraction from bottom of plot
    frac_lon = 0.5  # distance fraction from left of plot
    e1 = ax.get_extent()
    center_lon = e1[0] + frac_lon * (e1[1] - e1[0])
    center_lat = e1[2] + frac_lat * (e1[3] - e1[2])
    # Main line
    lat1, lon1 = gc_latlon_bear_dist(
        center_lat, center_lon, -90, scale / 2.0)  # left point
    lat2, lon2 = gc_latlon_bear_dist(
        center_lat, center_lon, 90, scale / 2.0)  # right point
    if lon1 &lt;= e1[0] or lon2 &gt;= e1[1]:
        warnings.warn(&#39;Scale line longer than extent of plot! &#39; +
                      &#39;Try shortening for best effect.&#39;)
    ax.plot([lon1, lon2], [lat1, lat2], linestyle=&#39;-&#39;,
            color=color, transform=projection, 
            linewidth=linewidth)
    # Draw a vertical hash on the left edge
    lat1a, lon1a = gc_latlon_bear_dist(
        lat1, lon1, 180, frac_lon * scale / 20.0)  # bottom left hash
    lat1b, lon1b = gc_latlon_bear_dist(
        lat1, lon1, 0, frac_lon * scale / 20.0)  # top left hash
    ax.plot([lon1a, lon1b], [lat1a, lat1b], linestyle=&#39;-&#39;,
            color=color, transform=projection, linewidth=linewidth)
    # Draw a vertical hash on the right edge
    lat2a, lon2a = gc_latlon_bear_dist(
        lat2, lon2, 180, frac_lon * scale / 20.0)  # bottom right hash
    lat2b, lon2b = gc_latlon_bear_dist(
        lat2, lon2, 0, frac_lon * scale / 20.0)  # top right hash
    ax.plot([lon2a, lon2b], [lat2a, lat2b], linestyle=&#39;-&#39;,
            color=color, transform=projection, linewidth=linewidth)
    # Draw scale label
    ax.text(center_lon, center_lat - frac_lat * (e1[3] - e1[2]) / 4.0,
            str(int(scale)) + &#39; km&#39;, horizontalalignment=&#39;center&#39;,
            verticalalignment=&#39;center&#39;, color=color, fontweight=fontweight,
            fontsize=fontsize)
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-reflectivity-with-the-pluvio-sensor-and-watershed-locations">
<h2>Plot the Reflectivity with the Pluvio Sensor and Watershed Locations<a class="headerlink" href="#plot-the-reflectivity-with-the-pluvio-sensor-and-watershed-locations" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def plot_reflectivity_sail(file, out_directory=&#39;.&#39;):
    &quot;&quot;&quot;
    Reads and plots data from the SAIL field campaign
    &quot;&quot;&quot;
    
    radar = pyart.io.read(file)

    elevation_contours = np.arange(2_700, 4_200, 250)

    fig = plt.figure(figsize=(12,8))

    ax = plt.subplot(111,
                     projection=ccrs.PlateCarree())

    #Setup a RadarMapDisplay, which gives our axes in lat/lon
    display = pyart.graph.RadarMapDisplay(radar)

    # Add our reflectivity (DBZ) field to the plot, including our gatefilter
    radar_plot = display.plot_ppi_map(&#39;DBZ&#39;,
                                      3,
                                      ax=ax,
                                      vmin=-20,
                                      min_lat=min_lat,
                                      max_lat=max_lat,
                                      min_lon=min_lon,
                                      max_lon=max_lon,
                                      embelish=False,
                                      colorbar_label=&quot;Horizontal Reflectivity Factor ($Z_{H}$) \n (dBZ)&quot;,
                                      vmax=40.,)

    cbar = display.cbs[0]
    cbar.set_ticklabels(np.arange(-20, 50, 10), fontsize=14)
    cbar.set_label(label=&#39;Horizontal Reflectivity Factor ($Z_{H}$) (dBZ)&#39;, fontsize=16)

    display.cbs = [cbar]


    east_river.plot(ax=ax,
                    linewidth=3,
                    edgecolor=&#39;k&#39;,
                    facecolor=&quot;None&quot;,
                    linestyle=&#39;--&#39;,)

    ax.plot(0,
            0,
            color=&#39;k&#39;,
            linestyle=&#39;:&#39;,
            linewidth=3,
            label=&#39;East River Basin&#39;)

    amf_sensor_locations.loc[amf_sensor_locations.Name == &#39;PLUVIO&#39;].plot(ax=ax,
                                                                         color=&#39;k&#39;,
                                                                         label=&#39;ARM AMF Site&#39;)

    plt.legend(loc=&#39;upper right&#39;,
               fontsize=14)

    plt.xlim(min_lon, max_lon)
    plt.ylim(min_lat, max_lat)

    # Add our scale bar
    add_scale_line(10.0, ax, projection=ccrs.PlateCarree(), 
                   color=&#39;black&#39;, linewidth=3,
                   fontsize=20,
                   fontweight=&#39;bold&#39;)

    # Add gridlines
    gl = ax.gridlines(crs=ccrs.PlateCarree(),
                       draw_labels=True,
                       linewidth=1, 
                       color=&#39;gray&#39;, 
                       alpha=0.3,
                       linestyle=&#39;--&#39;)

    plt.gca().xaxis.set_major_locator(plt.NullLocator())

    # Make sure labels are only plotted on the left and bottom
    gl.xlabels_top = False
    gl.ylabels_right = False

    gl.xlabel_style = {&#39;size&#39;: 14}
    gl.ylabel_style = {&#39;size&#39;: 14}

    third_sweep = radar.extract_sweeps([2])
    time = pd.to_datetime(third_sweep.time[&quot;data&quot;], unit=&#39;s&#39;).mean()
    time_in_label = time.strftime(&quot;%H%M UTC %d %b %Y&quot;)
    time_in_file = time.strftime(&quot;%B_%d_%H%M&quot;).lower()

    contours = terrain.to_dataset(name=&#39;DEM&#39;).DEM.plot.contour(levels=elevation_contours, cmap=&#39;Greys&#39;, alpha=0.6)
    ax.clabel(contours, elevation_contours[::2], fontsize=10, inline=1, fmt=&#39;%i m&#39;, rightside_up=True)
    #cbar_elevation.set_ticklabels(np.arange(2_000, 5_000, 750), fontsize=14)
    #cbar_elevation.set_label(label=&#39;Elevation (meters)&#39;, fontsize=16)

    plt.title(f&quot;Horizontal Reflectivity at 6° Elevation \n {time_in_label}&quot;, fontsize=20)

    plt.savefig(f&quot;{out_directory}/ppi_4deg_{time_in_file}.png&quot;, dpi=300, bbox_inches=&quot;tight&quot;)

    plt.show()
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>hour = &#39;12&#39;
file_list = sorted(glob.glob(f&quot;/gpfs/wolf/atm124/proj-shared/gucxprecipradarS2.00/glue_files/202204_glued/xprecipradar_guc_volume_20220412-*&quot;))

for file in file_list[::30]:
    plot_reflectivity_sail(file, out_directory=&#39;ppi_animation_april14&#39;)

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/plot-ams-figures_11_0.png" src="../_images/plot-ams-figures_11_0.png" />
<img alt="../_images/plot-ams-figures_11_1.png" src="../_images/plot-ams-figures_11_1.png" />
<img alt="../_images/plot-ams-figures_11_2.png" src="../_images/plot-ams-figures_11_2.png" />
<img alt="../_images/plot-ams-figures_11_3.png" src="../_images/plot-ams-figures_11_3.png" />
<img alt="../_images/plot-ams-figures_11_4.png" src="../_images/plot-ams-figures_11_4.png" />
<img alt="../_images/plot-ams-figures_11_5.png" src="../_images/plot-ams-figures_11_5.png" />
<img alt="../_images/plot-ams-figures_11_6.png" src="../_images/plot-ams-figures_11_6.png" />
<img alt="../_images/plot-ams-figures_11_7.png" src="../_images/plot-ams-figures_11_7.png" />
<img alt="../_images/plot-ams-figures_11_8.png" src="../_images/plot-ams-figures_11_8.png" />
</div>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import glob
ppi_images = sorted(glob.glob(&quot;ppi_animation_april14/*&quot;))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import imageio.v2 as imageio
with imageio.get_writer(&#39;april-ref-ppi-animation-6deg.gif&#39;, mode=&#39;I&#39;) as writer:
    for filename in ppi_images:
        image = imageio.imread(filename)
        writer.append_data(image)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "sail-radar-dev"
        },
        kernelOptions: {
            kernelName: "sail-radar-dev",
            path: "./radar-precip"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'sail-radar-dev'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="csu-xband-snowfall-march-14-2022.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Snowfall Retrievals CSU X-Band Radar March 14, 2022</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="plot-method-description-figure.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plot a Description of the Liquid Precip Estimation Method</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By ARM Development Team<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>